<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ventas</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- sidebar -->
    <nav class="sidebar">
        <div class="sidebar-header">
            <a href="#" class="brand-badge">
                <img src="assets/logo.png" alt="logo" class="sidebar-logo-img">
                <div class="d-flex flex-column">
                    <span class="brand-text-small">OPTICA</span>
                    <span class="brand-text-main">LATITUD VISUAL</span>
                </div>
            </a>
        </div>
        <div class="sidebar-menu">
            <a href="pacientes.html" class="nav-link">
                <i class="fa fa-users"></i> Pacientes
            </a>
            <a href="inventario.html" class="nav-link">
                <i class="fa fa-boxes"></i> Inventario
            </a>
            <a href="servicios.html" class="nav-link">
                <i class="fa fa-concierge-bell"></i> Servicios
            </a>
            <a href="ventas.html" class="nav-link active"> 
                <i class="fas fa-cash-register"></i> Ventas
            </a>
            <a href="fichas.html" class="nav-link">
                <i class="fa fa-file-medical"></i> Fichas Clínicas
            </a>
        </div>

        <div class="sidebar-footer">
            <a href="#" class="logout-link">
                <i class="fa fa-sign-out-alt me-3"></i> Cerrar sesión
            </a>
        </div>
    </nav>

    <!-- header -->
    <header class="top-header">
        <h4 class="mb-0 fw-bold text-dark">Dashboard</h4>
        <div class="d-flex align-items-center gap-3">
            <div class="text-end">
                <div class="fw-bold">Dra. Cumanda Delgado</div>
                <small class="text-muted">Administrador</small>
            </div>
            <img src="https://ui-avatars.com/api/?name=Cumanda+Delgado&background=0a2342&color=fff" class="rounded-circle" width="40" height="40" alt="Avatar">
        </div>
    </header>

    <!-- main -->
    <main class="main-content">
        <h2 class="page-title">Ventas</h2>

        <!-- barra busqueda y boton agregar -->
        <div class="row mb-4 align-items-center">
            <div class="col-md-6">
                <div class="input-group shadow-sm">
                    <span class="input-group-text bg-white ps-3">
                        <i class="fas fa-search"></i>
                    </span>
                    <input type="text" class="form-control py-2" id="searchVentas" placeholder="Buscar por paciente o ID venta">
                </div>
            </div>

            <div class="col-md-6 text-md-end">
                <button class="btn btn-orange" data-bs-toggle="modal" data-bs-target="#modalVenta">
                    <i class="fas fa-plus"></i> Nueva Venta
                </button>
            </div>                
        </div>

        <!-- Filtros -->
        <div class="row mb-3">
            <div class="col-md-3">
                <label class="form-label small fw-bold text-muted">Estado Pedido</label>
                <select class="form-select form-select-sm" id="filterEstadoPedido">
                    <option value="">Todos</option>
                    <option value="en-proceso">En Proceso</option>
                    <option value="listo">Listo para Entrega</option>
                    <option value="entregado">Entregado</option>
                </select>
            </div>
            <div class="col-md-3">
                <label class="form-label small fw-bold text-muted">Estado Pago</label>
                <select class="form-select form-select-sm" id="filterEstadoPago">
                    <option value="">Todos</option>
                    <option value="pendiente">Pendiente</option>
                    <option value="pagado">Pagado</option>
                </select>
            </div>
        </div>

        <!-- tabla ventas -->
        <div class="card-table">
            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                    <thead>
                        <tr>
                            <th>ID Venta</th>
                            <th>Paciente</th>
                            <th>Total</th>
                            <th>Abonado</th>
                            <th>Saldo</th>
                            <th>Estado Pedido</th>
                            <th>Estado Pago</th>
                            <th class="text-end">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="fw-bold" style="color: #0a2342;">#V-001</td>
                            <td>
                                <div class="fw-bold">Maria Chachalo</div>
                                <small class="text-muted">0985983071</small>
                            </td>
                            <td>$180.00</td>
                            <td>$100.00</td>
                            <td>$80.00</td>
                            <td>
                                <span class="badge bg-warning text-dark">En Proceso</span>
                            </td>
                            <td>
                                <span class="badge bg-danger">Pendiente</span>
                            </td>
                            <td class="text-end">
                                <button class="btn btn-light text-primary shadow-sm" title="Ver Detalles" data-bs-toggle="modal" data-bs-target="#modalDetalles">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button class="btn btn-light text-warning shadow-sm" title="Agregar Abono" data-bs-toggle="modal" data-bs-target="#modalAbono">
                                    <i class="fas fa-plus-circle"></i>
                                </button>
                                <button class="btn btn-light text-info shadow-sm" title="Actualizar Estado" data-bs-toggle="modal" data-bs-target="#modalEstado">
                                    <i class="fas fa-sync-alt"></i>
                                </button>
                                <button class="btn btn-light text-danger shadow-sm" title="Eliminar">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <!-- Modal Nueva Venta -->
    <div class="modal fade" id="modalVenta" tabindex="-1">
        <div class="modal-dialog modal-xl modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-cash-register me-2"></i>Nueva Venta
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body">
                    <form id="formVenta">
                        
                        <!-- Seleccionar Paciente -->
                        <div class="mb-4">
                            <label class="form-label fw-bold required-field">Paciente</label>
                            <div class="input-group">
                                <span class="input-group-text bg-white"><i class="fas fa-user"></i></span>
                                <input type="text" class="form-control" id="ventaPaciente" placeholder="Buscar paciente por cédula o nombre..." required>
                            </div>
                        </div>

                        <!-- Detalles de Venta -->
                        <div class="section-title mb-3">
                            <i class="fas fa-list me-2"></i>Ítems de la Venta
                        </div>

                        <div class="table-responsive mb-4">
                            <table class="table table-bordered table-sm align-middle">
                                <thead class="table-light">
                                    <tr>
                                        <th style="width: 40%;">Descripción</th>
                                        <th>Tipo</th>
                                        <th>Cantidad</th>
                                        <th>Precio</th>
                                        <th>Subtotal</th>
                                    </tr>
                                </thead>
                                <tbody id="detallesVenta">
                                </tbody>
                            </table>
                        </div>

                        <div class="row mb-4">
                            <div class="col-md-6">
                                <button type="button" class="btn btn-sm" style="background-color: transparent; color: #ff7f32; border: 2px solid #ff7f32;">
                                    <i class="fas fa-plus me-2"></i>Agregar Producto
                                </button>
                                <button type="button" class="btn btn-sm" style="background-color: transparent; color: #0a2342; border: 2px solid #0a2342; margin-left: 8px;">
                                    <i class="fas fa-plus me-2"></i>Agregar Servicio
                                </button>
                            </div>
                        </div>

                        <!-- Resumen -->
                        <div class="card bg-light border-0 mb-4">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="mb-3">
                                            <label class="form-label fw-bold small text-muted">Subtotal</label>
                                            <div class="fw-bold fs-5">$<span id="subtotal">0.00</span></div>
                                        </div>
                                    </div>
                                    <div class="col-md-6 text-md-end">
                                        <div class="mb-3">
                                            <label class="form-label fw-bold small text-muted">Total a Pagar</label>
                                            <div class="fw-bold fs-5">$<span id="totalVenta">0.00</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Abono -->
                        <div class="section-title mb-3">
                            <i class="fas fa-money-bill-wave me-2"></i>Pago Inicial
                        </div>

                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Monto Abono</label>
                                <div class="input-group">
                                    <span class="input-group-text">$</span>
                                    <input type="number" step="0.01" class="form-control" id="montoAbono" placeholder="0.00" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-bold">Medio de Pago</label>
                                <select class="form-select" id="medioPago" required>
                                    <option value="">Seleccionar</option>
                                    <option value="efectivo">Efectivo</option>
                                    <option value="transferencia">Transferencia</option>
                                    <option value="tarjeta">Tarjeta</option>
                                </select>
                            </div>
                        </div>

                    </form>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancelar
                    </button>
                    <button type="button" class="btn btn-orange" id="btnGuardarVenta">
                        <i class="fas fa-save me-2"></i>Guardar Venta
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Buscar Paciente -->
    <div class="modal fade" id="modalBuscaPaciente" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Buscar Paciente</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="input-group mb-3">
                        <input type="text" class="form-control" id="buscaPaciente" placeholder="Cédula o nombre...">
                        <button class="btn btn-outline-secondary" type="button">Buscar</button>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-hover table-sm">
                            <thead class="table-light">
                                <tr>
                                    <th>Cédula</th>
                                    <th>Nombre</th>
                                    <th>Teléfono</th>
                                    <th>Acción</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>0985983071</td>
                                    <td>Maria Chachalo</td>
                                    <td>0985983071</td>
                                    <td><button class="btn btn-sm btn-primary" data-bs-dismiss="modal">Seleccionar</button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Agregar Abono -->
    <div class="modal fade" id="modalAbono" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Agregar Abono</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="card bg-light mb-3">
                        <div class="card-body text-center">
                            <small class="text-muted d-block">Total: <span class="fw-bold">$180.00</span></small>
                            <small class="text-muted d-block">Abonado: <span class="fw-bold">$100.00</span></small>
                            <small class="text-muted d-block mt-2">Saldo: <span class="fw-bold text-danger">$80.00</span></small>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">Monto a Abonar</label>
                        <div class="input-group">
                            <span class="input-group-text">$</span>
                            <input type="number" step="0.01" class="form-control" id="montoAbonoNuevo" placeholder="0.00">
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-bold">Medio de Pago</label>
                        <select class="form-select" id="medioPagoAbono">
                            <option value="">Seleccionar</option>
                            <option value="efectivo">Efectivo</option>
                            <option value="transferencia">Transferencia</option>
                            <option value="tarjeta">Tarjeta</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-orange">Guardar Abono</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Actualizar Estado -->
    <div class="modal fade" id="modalEstado" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Actualizar Estado Pedido</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <label class="form-label fw-bold">Nuevo Estado</label>
                    <select class="form-select">
                        <option value="en-proceso">En Proceso</option>
                        <option value="listo">Listo para Entrega</option>
                        <option value="entregado">Entregado</option>
                    </select>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-orange">Actualizar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Ver Detalles -->
    <div class="modal fade" id="modalDetalles" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Detalles de la Venta #V-001</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row mb-3">
                        <div class="col-md-6">
                            <small class="text-muted">Paciente</small>
                            <div class="fw-bold">Maria Chachalo</div>
                        </div>
                        <div class="col-md-6 text-end">
                            <small class="text-muted">Fecha</small>
                            <div class="fw-bold">15 Nov 2024</div>
                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-sm">
                            <thead class="table-light">
                                <tr>
                                    <th>Descripción</th>
                                    <th>Cantidad</th>
                                    <th>Precio</th>
                                    <th>Subtotal</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Armazón Ray-Ban</td>
                                    <td>1</td>
                                    <td>$120.00</td>
                                    <td>$120.00</td>
                                </tr>
                                <tr>
                                    <td>Lunas</td>
                                    <td>1</td>
                                    <td>$60.00</td>
                                    <td>$60.00</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>